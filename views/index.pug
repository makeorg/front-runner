extends layout

append content
  h1= title
  script
      fbq('trackCustom', 'display-loader', {})
  .spinner__sub-wrapper
    .spinner__wrapper
      span.spinner
        svg(x="0" y="0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 66 66" height="40" width="40" class="spinner__shape")
          linearGradient(id="gradient")
            stop(offset="0" style="stop-color:rgb(0,0,0);stop-opacity:0;")
            stop(offset="1" style="stop-color:rgb(0,0,0);stop-opacity:1;")
          path(
            fill="url(#gradient)"
            d="M0,33C0,14.8,14.8,0,33,0s33,14.8,33,33S51.2,66,33,66S0,51.2,0,33z M6,33c0,14.9,12.1,27,27,27s27-12.1,27-27 S47.9,6,33,6S6,18.1,6,33z"
          )
  script.

  script(type="text/javascript" src="http://localhost:9019/make-front-fastopt-library.js")
  script.
    window.apiUrl= "!{apiUrl}";
    var exports = window;
    exports.require = window["makeApp"].require;
    function extractHostname(url) {
       var hostname;
       if (url.indexOf("://") > -1) {
           hostname = url.split('/')[2];
       }
       else {
           hostname = url.split('/')[0];
       }
       hostname = hostname.split(':')[0];
       hostname = hostname.split('?')[0];
       return hostname;
    }
    function extractAnchor(url) {
       urlParts = url.split('#');
       if (urlParts.length > 1) {
           return urlParts[1];
       }
       return "";
    }
    var referer = extractHostname(document.referrer);
    var anchor = extractAnchor(window.location.href);
    if (referer == "r.orange.fr" && (anchor == "" || anchor == "/" || anchor.toLowerCase() == "/fr")) {
     window.location.replace("https://about.make.org/about-mieux-vivre-ensemble?utm_campaign=mve&utm_source=orange&utm_medium=redirect")
    }

    var configuration = {
       "apiUrl": window.apiUrl,
       "googleAppId": "810331964280-qtdupbrjusihad3b5da51i5p66qpmhmr.apps.googleusercontent.com",
       "googleAdWordsId": "AW-819115721",
       "facebookAppId": "317128238675603",
       "detectedCountry": "FR",
       "forcedCountry": ""
    }

    // polyfill for Object.assign
    if (typeof Object.assign != 'function') {
     // Must be writable: true, enumerable: false, configurable: true
     Object.defineProperty(Object, "assign", {
       value: function assign(target, varArgs) { // .length of function is 2
         'use strict';
         if (target == null) { // TypeError if undefined or null
           throw new TypeError('Cannot convert undefined or null to object');
         }

         var to = Object(target);

         for (var index = 1; index < arguments.length; index++) {
           var nextSource = arguments[index];

           if (nextSource != null) { // Skip over if undefined or null
             for (var nextKey in nextSource) {
               // Avoid bugs when hasOwnProperty is shadowed
               if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {
                 to[nextKey] = nextSource[nextKey];
               }
             }
           }
         }
         return to;
       },
       writable: true,
       configurable: true
     });
    }

    // Facebook tracking
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '260470104426586');
    fbq('track', 'PageView');

    // Google tracking
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'AW-819115721');

    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-97647514-1');

  script(type="text/javascript" src="http://localhost:9019/make-front-fastopt.js")
  noscript
    img(height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=260470104426586&ev=PageView&noscript=1")
